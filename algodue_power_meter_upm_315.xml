<?xml version="1.0"?>
<!-- Algodue Power Meter UPM 315 -->
<APC_DDF xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="apc_ddf_1_6.xsd"
        ddfid ="algodue_power_meter_upm_315" ddfname="Algodue Power Meter UPM 315"
        ddfversion ="3" canremove="yes">
  <schemaVersion>1.6</schemaVersion>

  <device deviceid="algodue_upm_315_header">
    <oidMustExist oid="MODBUS_OID_MUST_EXIST" ruleid="OIDMustExist_modbusdevicetest"/>
    <setProductData ruleid="typedata" field="type">Power Meter</setProductData>
    <setProductData ruleid="vendordata" field="vendor">Algodue Electronica</setProductData>
    <setProductData ruleid="modeldata" field="model">UPM 315</setProductData>
		<setDefaultLabel ruleid="labeldata"><sysHostname/> - Slave <commSetting field="slaveaddress"/></setDefaultLabel>

  </device>

  <device deviceid="algodue_upm_315_sensors">
    <oidMustExist oid="MODBUS_OID_MUST_EXIST" ruleid="OIDMustExist_modbusdevicetest"/>

    <numSensor ruleid="VoltageLineToNeutralTable_Sensor" index="VoltageLineToNeutralTable">
      <type>voltage/outputl2n/phase</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>VoltageLineToNeutralTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="VoltageLineToNeutralTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="VoltageLineToLineTable_Sensor" index="VoltageLineToLineTable">
      <type>voltage/outputl2l/phase</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>VoltageLineToLineTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="VoltageLineToLineTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="CurrentByPhaseTable_Sensor" index="CurrentByPhaseTable">
      <type>amperage</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>CurrentByPhaseTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="CurrentByPhaseTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="CurrentTHD_ByPhaseTable_Sensor" index="CurrentTHD_ByPhaseTable">
      <type>pctofcapacity</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>CurrentTHD_ByPhaseTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="CurrentTHD_ByPhaseTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="PowerFactorTable_Sensor" index="PowerFactorTable">
      <type>num/powerfactor</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>PowerFactorTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="PowerFactorTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Power Factor Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="ApparentPowerTable_Sensor" index="ApparentPowerTable">
      <type>powerVA/apparentpower/phase</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>ApparentPowerTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="ApparentPowerTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Apparent Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="ActivePowerTable_Sensor" index="ActivePowerTable">
      <type>powerW/power/phase</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>ActivePowerTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="ActivePowerTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Active Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="ReactivePowerTable_Sensor" index="ReactivePowerTable">
      <type>powerVA/powerVAR</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>ReactivePowerTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="ReactivePowerTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Reactive Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="system_voltage_Sensor">
      <type>voltageAC</type>
      <sensorId>SYSTEM_VOLTAGE</sensorId>
      <value>
        <mult>
          <op>
            <getOid>system_voltage</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>System Voltage</label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="system_current_Sensor">
      <type>amperage</type>
      <sensorId>SYSTEM_CURRENT</sensorId>
      <value>
        <mult>
          <op>
            <getOid>system_current</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>System Current</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="neutral_current_Sensor">
      <type>amperage</type>
      <sensorId>NEUTRAL_CURRENT</sensorId>
      <value>
        <mult>
          <op>
            <getOid>neutral_current</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Neutral Current</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="total_apparent_power_Sensor">
      <type>powerVA/apparentpower/total</type>
      <sensorId>TOTAL_APPARENT_POWER</sensorId>
      <value>
        <mult>
          <op>
            <getOid>total_apparent_power</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Total Apparent Power</label>
      <sensorSet>Apparent Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="total_active_power_Sensor">
      <type>powerW/systemTotalPower</type>
      <sensorId>TOTAL_ACTIVE_POWER</sensorId>
      <value>
        <mult>
          <op>
            <getOid>total_active_power</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Total Active Power</label>
      <sensorSet>Active Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="total_reactive_power_Sensor">
      <type>powerVA/powerVAR</type>
      <sensorId>TOTAL_REACTIVE_POWER</sensorId>
      <value>
        <mult>
          <op>
            <getOid>total_reactive_power</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Total Reactive Power</label>
      <sensorSet>Reactive Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="imported_active_energy_Sensor">
      <type>num/kwatthr</type>
      <sensorId>IMPORTED_ACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>imported_active_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Imported Active Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="imported_reactive_inductive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>IMPORTED_REACTIVE_INDUCTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>imported_reactive_inductive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Imported Reactive Inductive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="imported_reactive_capacitive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>IMPORTED_REACTIVE_CAPACITIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>imported_reactive_capacitive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Imported Reactive Capacitive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="line_frequency_Sensor">
      <type>frequency</type>
      <sensorId>LINE_FREQUENCY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>line_frequency</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Line Frequency</label>
      <sensorSet>System Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="VoltageTHD_Table_Sensor" index="VoltageTHD_Table">
      <type>pctofcapacity</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>VoltageTHD_Table</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="VoltageTHD_TableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="phase_order_Sensor">
      <type>num</type>
      <sensorId>PHASE_ORDER</sensorId>
      <value>
        <getOid>phase_order</getOid>
      </value>
      <valueInc>1.0</valueInc>
      <label>Phase Order</label>
      <sensorSet>System Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="voltage_unbalance_Sensor">
      <type>pctofcapacity</type>
      <sensorId>VOLTAGE_UNBALANCE</sensorId>
      <value>
        <mult>
          <op>
            <getOid>voltage_unbalance</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Voltage unbalance</label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="current_unbalance_Sensor">
      <type>pctofcapacity</type>
      <sensorId>CURRENT_UNBALANCE</sensorId>
      <value>
        <mult>
          <op>
            <getOid>current_unbalance</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Current Unbalance</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="imported_apparent_inductive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>IMPORTED_APPARENT_INDUCTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>imported_apparent_inductive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Imported Apparent Inductive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="imported_apparent_capacitive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>IMPORTED_APPARENT_CAPACITIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>imported_apparent_capacitive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Imported Apparent Capacitive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="minimum_system_voltage_Sensor">
      <type>voltageAC</type>
      <sensorId>MINIMUM_SYSTEM_VOLTAGE</sensorId>
      <value>
        <mult>
          <op>
            <getOid>minimum_system_voltage</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Minimum System Voltage</label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="peak_system_voltage_Sensor">
      <type>voltageAC</type>
      <sensorId>PEAK_SYSTEM_VOLTAGE</sensorId>
      <value>
        <mult>
          <op>
            <getOid>peak_system_voltage</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Peak System Voltage</label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="PeakLineToNeutralVoltageTable_Sensor" index="PeakLineToNeutralVoltageTable">
      <type>voltageAC</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>PeakLineToNeutralVoltageTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="PeakLineToNeutralVoltageTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="MinLineToNeutralVoltageTable_Sensor" index="MinLineToNeutralVoltageTable">
      <type>voltageAC</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>MinLineToNeutralVoltageTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="MinLineToNeutralVoltageTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Voltage Sensors</sensorSet>
    </numSensor>


    <numSensor ruleid="minimum_system_current_Sensor">
      <type>amperage</type>
      <sensorId>MINIMUM_SYSTEM_CURRENT</sensorId>
      <value>
        <mult>
          <op>
            <getOid>minimum_system_current</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Minimum System Current</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="peak_system_current_Sensor">
      <type>amperage</type>
      <sensorId>PEAK_SYSTEM_CURRENT</sensorId>
      <value>
        <mult>
          <op>
            <getOid>peak_system_current</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Peak System Current</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="PeakLinePhaseCurrentTable_Sensor" index="PeakLinePhaseCurrentTable">
      <type>amperage</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>PeakLinePhaseCurrentTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="PeakLinePhaseCurrentTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="MinLinePhaseCurrentTable_Sensor" index="MinLinePhaseCurrentTable">
      <type>amperage</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>MinLinePhaseCurrentTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="MinLinePhaseCurrentTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="minimum_power_factor_Sensor">
      <type>num/powerfactor</type>
      <sensorId>MINIMUM_POWER_FACTOR</sensorId>
      <value>
        <mult>
          <op>
            <getOid>minimum_power_factor</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Minimum Power Factor</label>
      <sensorSet>Power Factor Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="peak_power_factor_Sensor">
      <type>num/powerfactor</type>
      <sensorId>PEAK_POWER_FACTOR</sensorId>
      <value>
        <mult>
          <op>
            <getOid>peak_power_factor</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Peak Power Factor</label>
      <sensorSet>Power Factor Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="minimum_system_frequency_Sensor">
      <type>frequency</type>
      <sensorId>MINIMUM_SYSTEM_FREQUENCY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>minimum_system_frequency</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Minimum Frequency</label>
      <sensorSet>System Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="peak_system_frequency_Sensor">
      <type>frequency</type>
      <sensorId>PEAK_SYSTEM_FREQUENCY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>peak_system_frequency</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Peak System Frequency</label>
      <sensorSet>System Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="active_power_demand_peak_Sensor">
      <type>powerW</type>
      <sensorId>ACTIVE_POWER_DEMAND_PEAK</sensorId>
      <value>
        <mult>
          <op>
            <getOid>active_power_demand_peak</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Peak Active Power Demand</label>
      <sensorSet>Active Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="apparent_power_demand_peak_Sensor">
      <type>powerVA</type>
      <sensorId>APPARENT_POWER_DEMAND_PEAK</sensorId>
      <value>
        <mult>
          <op>
            <getOid>apparent_power_demand_peak</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Peak Apparent Power Demand</label>
      <sensorSet>Apparent Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="current_demand_peak_Sensor">
      <type>amperage</type>
      <sensorId>CURRENT_DEMAND_PEAK</sensorId>
      <value>
        <mult>
          <op>
            <getOid>current_demand_peak</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Current Demand Peak</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="system_current_demand_Sensor">
      <type>amperage</type>
      <sensorId>SYSTEM_CURRENT_DEMAND</sensorId>
      <value>
        <mult>
          <op>
            <getOid>system_current_demand</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>System Current Demand</label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="PeakPhaseDemandCurrentTable_Sensor" index="PeakPhaseDemandCurrentTable">
      <type>amperage</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>PeakPhaseDemandCurrentTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="PeakPhaseDemandCurrentTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="system_active_power_demand_Sensor">
      <type>powerW</type>
      <sensorId>SYSTEM_ACTIVE_POWER_DEMAND</sensorId>
      <value>
        <mult>
          <op>
            <getOid>system_active_power_demand</getOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>System Active Power Demand</label>
      <sensorSet>Active Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="system_apparent_power_demand_Sensor">
      <type>num/powerKVA</type>
      <sensorId>SYSTEM_APPARENT_POWER_DEMAND</sensorId>
      <value>
        <mult>
          <op>
            <getOid>system_apparent_power_demand</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>System Apparent Power Demand</label>
      <sensorSet>Apparent Power Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="CurrentDemandTable_Sensor" index="CurrentDemandTable">
      <type>amperage</type>
      <sensorId><rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>CurrentDemandTable</getRowOid>
          </op>
          <op>0.001</op>
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label><mapValue mapid="CurrentDemandTableLabel-vm"><rowIndex/></mapValue></label>
      <sensorSet>Current Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="this_month_imported_active_energy_Sensor">
      <type>num/kwatthr</type>
      <sensorId>THIS_MONTH_IMPORTED_ACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>this_month_imported_active_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>This month - Imported Active Energy</label>
      <sensorSet>Time of Use 'This Month' Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="this_month_imported_inductive_reactive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>THIS_MONTH_IMPORTED_INDUCTIVE_REACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>this_month_imported_inductive_reactive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>This month - Imported Reactive Inductive Energy</label>
      <sensorSet>Time of Use 'This Month' Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="this_month_imported_capacitive_reactive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>THIS_MONTH_IMPORTED_CAPACITIVE_REACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>this_month_imported_capacitive_reactive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>This month - imported capacitive reactive energy</label>
      <sensorSet>Time of Use 'This Month' Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="this_month_import_inductive_apparent_energy_Sensor">
      <type>num/kVAhr</type>
      <sensorId>THIS_MONTH_IMPORT_INDUCTIVE_APPARENT_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>this_month_import_inductive_apparent_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>This month - Import Apparent Inductive Energy</label>
      <sensorSet>Time of Use 'This Month' Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="this_month_import_capacitive_apparent_energy_Sensor">
      <type>num/kVAhr</type>
      <sensorId>THIS_MONTH_IMPORT_CAPACITIVE_APPARENT_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>this_month_import_capacitive_apparent_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>This month - Imported Apparent Capacitive Energy</label>
      <sensorSet>Time of Use 'This Month' Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="previous_day_imported_active_energy_Sensor">
      <type>num/kwatthr</type>
      <sensorId>PREVIOUS_DAY_IMPORTED_ACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>previous_day_imported_active_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Previous day - Imported Active Energy</label>
      <sensorSet>Time of Use 'Previous Day' Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="previous_day_imported_inductive_reactive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>PREVIOUS_DAY_IMPORTED_INDUCTIVE_REACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>previous_day_imported_inductive_reactive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Previous day - Imported Reactive Inductive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="previous_day_imported_capacitive_reactive_energy_Sensor">
      <type>num/kVARhr</type>
      <sensorId>PREVIOUS_DAY_IMPORTED_CAPACITIVE_REACTIVE_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>previous_day_imported_capacitive_reactive_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Previous day - Imported Reactive Capacitive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="previous_day_import_inductive_apparent_energy_Sensor">
      <type>num/kVAhr</type>
      <sensorId>PREVIOUS_DAY_IMPORT_INDUCTIVE_APPARENT_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>previous_day_import_inductive_apparent_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Previous day - Imported Apparent Inductive Energy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <numSensor ruleid="previous_day_import_capacitive_apparent_energy_Sensor">
      <type>num/kVAhr</type>
      <sensorId>PREVIOUS_DAY_IMPORT_CAPACITIVE_APPARENT_ENERGY</sensorId>
      <value>
        <mult>
          <op>
            <getOid>previous_day_import_capacitive_apparent_energy</getOid>
          </op>
          <op>0.000001</op> <!-- Convert milli to kilo -->
        </mult>
      </value>
      <valueInc>0.001</valueInc>
      <label>Previous day - Imported Apparent Capacitive Anergy</label>
      <sensorSet>Energy Sensors</sensorSet>
    </numSensor>

    <valueMap ruleid="VoltageLineToNeutralTableLabel-vm">
      <valueIn>L-N_VOLTAGE_PHASE_1</valueIn><valueOut>L-N Voltage Phase 1</valueOut>
      <valueIn>L-N_VOLTAGE_PHASE_2</valueIn><valueOut>L-N Voltage Phase 2</valueOut>
      <valueIn>L-N_VOLTAGE_PHASE_3</valueIn><valueOut>L-N Voltage Phase 3</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="VoltageLineToLineTableLabel-vm">
      <valueIn>L-L_VOLTAGE_LINE_12</valueIn><valueOut>L-L Voltage Line 1-2</valueOut>
      <valueIn>L-L_VOLTAGE_LINE_23</valueIn><valueOut>L-L Voltage Line 2-3</valueOut>
      <valueIn>L-L_VOLTAGE_LINE_31</valueIn><valueOut>L-L Voltage Line 3-1</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="CurrentByPhaseTableLabel-vm">
      <valueIn>PHASE_1_CURRENT</valueIn><valueOut>Phase 1 Current</valueOut>
      <valueIn>PHASE_2_CURRENT</valueIn><valueOut>Phase 2 Current</valueOut>
      <valueIn>PHASE_3_CURRENT</valueIn><valueOut>Phase 3 Current</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="CurrentTHD_ByPhaseTableLabel-vm">
      <valueIn>PHASE_1_CURRENT_THD</valueIn><valueOut>Phase 1 Current THD</valueOut>
      <valueIn>PHASE_2_CURRENT_THD</valueIn><valueOut>Phase 2 Current THD</valueOut>
      <valueIn>PHASE_3_CURRENT_THD</valueIn><valueOut>Phase 3 Current THD</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="PowerFactorTableLabel-vm">
      <valueIn>POWER_FACTOR</valueIn><valueOut>System Power Factor</valueOut>
      <valueIn>PHASE_1_POWER_FACTOR</valueIn><valueOut>Phase 1 Power Factor</valueOut>
      <valueIn>PHASE_2_POWER_FACTOR</valueIn><valueOut>Phase 2 Power Factor</valueOut>
      <valueIn>PHASE_3_POWER_FACTOR</valueIn><valueOut>Phase 3 Power Factor</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="ApparentPowerTableLabel-vm">
      <valueIn>PHASE_1_APPARENT_POWER</valueIn><valueOut>Phase 1 Apparent Power</valueOut>
      <valueIn>PHASE_2_APPARENT_POWER</valueIn><valueOut>Phase 2 Apparent Power</valueOut>
      <valueIn>PHASE_3_APPARENT_POWER</valueIn><valueOut>Phase 3 Apparent Power</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="ActivePowerTableLabel-vm">
      <valueIn>PHASE_1_ACTIVE_POWER</valueIn><valueOut>Phase 1 Active Power</valueOut>
      <valueIn>PHASE_2_ACTIVE_POWER</valueIn><valueOut>Phase 2 Active Power</valueOut>
      <valueIn>PHASE_3_ACTIVE_POWER</valueIn><valueOut>Phase 3 Active Power</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="ReactivePowerTableLabel-vm">
      <valueIn>PHASE_1_REACTIVE_POWER</valueIn><valueOut>Phase 1 Reactive Power</valueOut>
      <valueIn>PHASE_2_REACTIVE_POWER</valueIn><valueOut>Phase 2 Reactive Power</valueOut>
      <valueIn>PHASE_3_REACTIVE_POWER</valueIn><valueOut>Phase 3 Reactive Power</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="VoltageTHD_TableLabel-vm">
      <valueIn>PHASE_1_VOLTAGE_THD</valueIn><valueOut>Phase 1 Voltage THD</valueOut>
      <valueIn>PHASE_2_VOLTAGE_THD</valueIn><valueOut>Phase 2 Voltage THD</valueOut>
      <valueIn>PHASE_3_VOLTAGE_THD</valueIn><valueOut>Phase 3 Voltage THD</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="CurrentDemandTableLabel-vm">
      <valueIn>PHASE_1_CURRENT_DEMAND</valueIn><valueOut>Phase 1 Current Demand</valueOut>
      <valueIn>PHASE_2_CURRENT_DEMAND</valueIn><valueOut>Phase 2 Current Demand</valueOut>
      <valueIn>PHASE_3_CURRENT_DEMAND</valueIn><valueOut>Phase 3 Current Demand</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="PeakLineToNeutralVoltageTableLabel-vm">
      <valueIn>PEAK_L-N_PHASE_1_VOLTAGE</valueIn><valueOut>Peak L-N Phase 1 Voltage</valueOut>
      <valueIn>PEAK_L-N_PHASE_2_VOLTAGE</valueIn><valueOut>Peak L-N Phase 2 Voltage</valueOut>
      <valueIn>PEAK_L-N_PHASE_3_VOLTAGE</valueIn><valueOut>Peak L-N Phase 3 Voltage</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="MinLineToNeutralVoltageTableLabel-vm">
      <valueIn>MINIMUM_L-N_PHASE_1_VOLTAGE</valueIn><valueOut>Minimum L-N Phase 1 Voltage</valueOut>
      <valueIn>MINIMUM_L-N_PHASE_2_VOLTAGE</valueIn><valueOut>Minimum L-N Phase 2 Voltage</valueOut>
      <valueIn>MINIMUM_L-N_PHASE_3_VOLTAGE</valueIn><valueOut>Minimum L-N Phase 3 Voltage</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="PeakLinePhaseCurrentTableLabel-vm">
      <valueIn>PEAK_PHASE_1_CURRENT</valueIn><valueOut>Peak Phase 1 Current</valueOut>
      <valueIn>PEAK_PHASE_2_CURRENT</valueIn><valueOut>Peak Phase 2 Current</valueOut>
      <valueIn>PEAK_PHASE_3_CURRENT</valueIn><valueOut>Peak Phase 3 Current</valueOut>
      <valueIn>PEAK_PHASE_NEUTRAL_CURRENT</valueIn><valueOut>Peak Phase Neutral Current</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="MinLinePhaseCurrentTableLabel-vm">
      <valueIn>MINIMUM_PHASE_1_CURRENT</valueIn><valueOut>Minimum Phase 1 Current</valueOut>
      <valueIn>MINIMUM_PHASE_2_CURRENT</valueIn><valueOut>Minimum Phase 2 Current</valueOut>
      <valueIn>MINIMUM_PHASE_3_CURRENT</valueIn><valueOut>Minimum Phase 3 Current</valueOut>
      <valueIn>MINIMUM_PHASE_NEUTRAL_CURRENT</valueIn><valueOut>Minimum Phase Neutral Current</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="PeakPhaseDemandCurrentTableLabel-vm">
      <valueIn>PEAK_PHASE_1_DEMAND_CURRENT</valueIn><valueOut>Peak Phase 1 Current Demand</valueOut>
      <valueIn>PEAK_PHASE_2_DEMAND_CURRENT</valueIn><valueOut>Peak Phase 2 Current Demand</valueOut>
      <valueIn>PEAK_PHASE_3_DEMAND_CURRENT</valueIn><valueOut>Peak Phase 3 Current Demand</valueOut>
      <valueIn>PEAK_DEMAND_CURRENT</valueIn><valueOut>Peak Current Demand</valueOut>
      <valueIn>*</valueIn> <valueOut>*</valueOut>
    </valueMap>

    <valueMap ruleid="status-vm">
      <valueIn>0</valueIn><valueOut>0</valueOut>
      <valueIn>1</valueIn><valueOut>1</valueOut>
      <valueIn>*</valueIn><valueOut>2</valueOut>
    </valueMap>

    <enumMap ruleid="alarm-em">
      <label>Normal</label>
      <label>Alarm</label>
      <label>Unknown</label>
    </enumMap>

  </device>
  <protocol>
    <modbus>
    <table_ref_id indexid="VoltageLineToNeutralTable">
      <entry num="0">L-N_VOLTAGE_PHASE_1</entry>
      <entry num="1">L-N_VOLTAGE_PHASE_2</entry>
      <entry num="2">L-N_VOLTAGE_PHASE_3</entry>
    </table_ref_id>

    <table_ref_id indexid="VoltageLineToLineTable">
      <entry num="0">L-L_VOLTAGE_LINE_12</entry>
      <entry num="1">L-L_VOLTAGE_LINE_23</entry>
      <entry num="2">L-L_VOLTAGE_LINE_31</entry>
    </table_ref_id>

    <table_ref_id indexid="CurrentByPhaseTable">
      <entry num="0">PHASE_1_CURRENT</entry>
      <entry num="1">PHASE_2_CURRENT</entry>
      <entry num="2">PHASE_3_CURRENT</entry>
    </table_ref_id>

    <table_ref_id indexid="CurrentTHD_ByPhaseTable">
      <entry num="0">PHASE_1_CURRENT_THD</entry>
      <entry num="1">PHASE_2_CURRENT_THD</entry>
      <entry num="2">PHASE_3_CURRENT_THD</entry>
    </table_ref_id>

    <table_ref_id indexid="PowerFactorTable">
      <entry num="0">POWER_FACTOR</entry>
      <entry num="1">PHASE_1_POWER_FACTOR</entry>
      <entry num="2">PHASE_2_POWER_FACTOR</entry>
      <entry num="3">PHASE_3_POWER_FACTOR</entry>
    </table_ref_id>

    <table_ref_id indexid="ApparentPowerTable">
      <entry num="0">PHASE_1_APPARENT_POWER</entry>
      <entry num="1">PHASE_2_APPARENT_POWER</entry>
      <entry num="2">PHASE_3_APPARENT_POWER</entry>
    </table_ref_id>

    <table_ref_id indexid="ActivePowerTable">
      <entry num="0">PHASE_1_ACTIVE_POWER</entry>
      <entry num="1">PHASE_2_ACTIVE_POWER</entry>
      <entry num="2">PHASE_3_ACTIVE_POWER</entry>
    </table_ref_id>

    <table_ref_id indexid="ReactivePowerTable">
      <entry num="0">PHASE_1_REACTIVE_POWER</entry>
      <entry num="1">PHASE_2_REACTIVE_POWER</entry>
      <entry num="2">PHASE_3_REACTIVE_POWER</entry>
    </table_ref_id>

    <table_ref_id indexid="VoltageTHD_Table">
      <entry num="0">PHASE_1_VOLTAGE_THD</entry>
      <entry num="1">PHASE_2_VOLTAGE_THD</entry>
      <entry num="2">PHASE_3_VOLTAGE_THD</entry>
    </table_ref_id>

    <table_ref_id indexid="CurrentDemandTable">
      <entry num="0">PHASE_1_CURRENT_DEMAND</entry>
      <entry num="1">PHASE_2_CURRENT_DEMAND</entry>
      <entry num="2">PHASE_3_CURRENT_DEMAND</entry>
    </table_ref_id>

    <table_ref_id indexid="PeakLineToNeutralVoltageTable">
      <entry num="0">PEAK_L-N_PHASE_1_VOLTAGE</entry>
      <entry num="1">PEAK_L-N_PHASE_2_VOLTAGE</entry>
      <entry num="2">PEAK_L-N_PHASE_3_VOLTAGE</entry>
    </table_ref_id>

    <table_ref_id indexid="MinLineToNeutralVoltageTable">
      <entry num="0">MINIMUM_L-N_PHASE_1_VOLTAGE</entry>
      <entry num="1">MINIMUM_L-N_PHASE_2_VOLTAGE</entry>
      <entry num="2">MINIMUM_L-N_PHASE_3_VOLTAGE</entry>
    </table_ref_id>

    <table_ref_id indexid="PeakLinePhaseCurrentTable">
      <entry num="0">PEAK_PHASE_1_CURRENT</entry>
      <entry num="1">PEAK_PHASE_2_CURRENT</entry>
      <entry num="2">PEAK_PHASE_3_CURRENT</entry>
      <entry num="3">PEAK_PHASE_NEUTRAL_CURRENT</entry>
    </table_ref_id>

    <table_ref_id indexid="MinLinePhaseCurrentTable">
      <entry num="0">MINIMUM_PHASE_1_CURRENT</entry>
      <entry num="1">MINIMUM_PHASE_2_CURRENT</entry>
      <entry num="2">MINIMUM_PHASE_3_CURRENT</entry>
      <entry num="3">MINIMUM_PHASE_NEUTRAL_CURRENT</entry>
    </table_ref_id>

    <table_ref_id indexid="PeakPhaseDemandCurrentTable">
      <entry num="0">PEAK_PHASE_1_DEMAND_CURRENT</entry>
      <entry num="1">PEAK_PHASE_2_DEMAND_CURRENT</entry>
      <entry num="2">PEAK_PHASE_3_DEMAND_CURRENT</entry>
      <entry num="2">PEAK_DEMAND_CURRENT</entry>
    </table_ref_id>

    <value_ref_id valid="system_voltage">
      <function>3</function>
      <start_addr>4096</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="L-N_VOLTAGE_PHASE_1">
      <function>3</function>
      <start_addr>4098</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="L-N_VOLTAGE_PHASE_2">
      <function>3</function>
      <start_addr>4100</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="L-N_VOLTAGE_PHASE_3">
      <function>3</function>
      <start_addr>4102</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="L-L_VOLTAGE_LINE_12">
      <function>3</function>
      <start_addr>4104</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="L-L_VOLTAGE_LINE_23">
      <function>3</function>
      <start_addr>4106</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="L-L_VOLTAGE_LINE_31">
      <function>3</function>
      <start_addr>4108</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="system_current">
      <function>3</function>
      <start_addr>4110</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_CURRENT">
      <function>3</function>
      <start_addr>4112</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_CURRENT">
      <function>3</function>
      <start_addr>4114</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_CURRENT">
      <function>3</function>
      <start_addr>4116</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_CURRENT_THD">
      <function>3</function>
      <start_addr>4174</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_CURRENT_THD">
      <function>3</function>
      <start_addr>4176</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_CURRENT_THD">
      <function>3</function>
      <start_addr>4178</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="neutral_current">
      <function>3</function>
      <start_addr>4192</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="POWER_FACTOR">
      <function>3</function>
      <start_addr>4118</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_POWER_FACTOR">
      <function>3</function>
      <start_addr>4120</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_POWER_FACTOR">
      <function>3</function>
      <start_addr>4122</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_POWER_FACTOR">
      <function>3</function>
      <start_addr>4124</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="total_apparent_power">
      <function>3</function>
      <start_addr>4134</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_APPARENT_POWER">
      <function>3</function>
      <start_addr>4136</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_APPARENT_POWER">
      <function>3</function>
      <start_addr>4138</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_APPARENT_POWER">
      <function>3</function>
      <start_addr>4140</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="total_active_power">
      <function>3</function>
      <start_addr>4142</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_ACTIVE_POWER">
      <function>3</function>
      <start_addr>4144</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_ACTIVE_POWER">
      <function>3</function>
      <start_addr>4146</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_ACTIVE_POWER">
      <function>3</function>
      <start_addr>4148</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="total_reactive_power">
      <function>3</function>
      <start_addr>4150</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_REACTIVE_POWER">
      <function>3</function>
      <start_addr>4152</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_REACTIVE_POWER">
      <function>3</function>
      <start_addr>4154</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_REACTIVE_POWER">
      <function>3</function>
      <start_addr>4156</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="imported_active_energy">
      <function>3</function>
      <start_addr>4158</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="imported_reactive_inductive_energy">
      <function>3</function>
      <start_addr>4160</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="imported_reactive_capacitive_energy">
      <function>3</function>
      <start_addr>4184</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="line_frequency">
      <function>3</function>
      <start_addr>4166</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_VOLTAGE_THD">
      <function>3</function>
      <start_addr>4168</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_VOLTAGE_THD">
      <function>3</function>
      <start_addr>4170</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_VOLTAGE_THD">
      <function>3</function>
      <start_addr>4172</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="phase_order">
      <function>3</function>
      <start_addr>4126</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="voltage_unbalance">
      <function>3</function>
      <start_addr>5042</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="current_unbalance">
      <function>3</function>
      <start_addr>5040</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="imported_apparent_inductive_energy">
      <function>3</function>
      <start_addr>5044</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="imported_apparent_capacitive_energy">
      <function>3</function>
      <start_addr>5046</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="minimum_system_voltage">
      <function>3</function>
      <start_addr>4224</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="peak_system_voltage">
      <function>3</function>
      <start_addr>4238</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_L-N_PHASE_1_VOLTAGE">
      <function>3</function>
      <start_addr>4252</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_L-N_PHASE_1_VOLTAGE">
      <function>3</function>
      <start_addr>4266</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_L-N_PHASE_2_VOLTAGE">
      <function>3</function>
      <start_addr>4280</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_L-N_PHASE_2_VOLTAGE">
      <function>3</function>
      <start_addr>4294</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_L-N_PHASE_3_VOLTAGE">
      <function>3</function>
      <start_addr>4308</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_L-N_PHASE_3_VOLTAGE">
      <function>3</function>
      <start_addr>4322</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="minimum_system_current">
      <function>3</function>
      <start_addr>4420</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="peak_system_current">
      <function>3</function>
      <start_addr>4434</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_PHASE_1_CURRENT">
      <function>3</function>
      <start_addr>4448</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_1_CURRENT">
      <function>3</function>
      <start_addr>4200</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_PHASE_2_CURRENT">
      <function>3</function>
      <start_addr>4476</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_2_CURRENT">
      <function>3</function>
      <start_addr>4202</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_PHASE_3_CURRENT">
      <function>3</function>
      <start_addr>4504</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_3_CURRENT">
      <function>3</function>
      <start_addr>4204</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="MINIMUM_PHASE_NEUTRAL_CURRENT">
      <function>3</function>
      <start_addr>4544</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_NEUTRAL_CURRENT">
      <function>3</function>
      <start_addr>4546</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="minimum_power_factor">
      <function>3</function>
      <start_addr>4560</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="peak_power_factor">
      <function>3</function>
      <start_addr>4574</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="minimum_system_frequency">
      <function>3</function>
      <start_addr>4840</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="peak_system_frequency">
      <function>3</function>
      <start_addr>4854</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="active_power_demand_peak">
      <function>3</function>
      <start_addr>4208</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="apparent_power_demand_peak">
      <function>3</function>
      <start_addr>4210</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="current_demand_peak">
      <function>3</function>
      <start_addr>4868</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_1_DEMAND_CURRENT">
      <function>3</function>
      <start_addr>4882</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_2_DEMAND_CURRENT">
      <function>3</function>
      <start_addr>4896</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_PHASE_3_DEMAND_CURRENT">
      <function>3</function>
      <start_addr>4910</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PEAK_DEMAND_CURRENT">
      <function>3</function>
      <start_addr>4206</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="system_active_power_demand">
      <function>3</function>
      <start_addr>4196</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="system_apparent_power_demand">
      <function>3</function>
      <start_addr>4198</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="system_current_demand">
      <function>3</function>
      <start_addr>4194</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_1_CURRENT_DEMAND">
      <function>3</function>
      <start_addr>4996</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_2_CURRENT_DEMAND">
      <function>3</function>
      <start_addr>4998</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="PHASE_3_CURRENT_DEMAND">
      <function>3</function>
      <start_addr>5000</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="this_month_imported_active_energy">
      <function>3</function>
      <start_addr>5172</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="this_month_imported_inductive_reactive_energy">
      <function>3</function>
      <start_addr>5174</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="this_month_imported_capacitive_reactive_energy">
      <function>3</function>
      <start_addr>5176</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="this_month_import_inductive_apparent_energy">
      <function>3</function>
      <start_addr>5178</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="this_month_import_capacitive_apparent_energy">
      <function>3</function>
      <start_addr>5180</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="previous_day_imported_active_energy">
      <function>3</function>
      <start_addr>5112</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="previous_day_imported_inductive_reactive_energy">
      <function>3</function>
      <start_addr>5114</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="previous_day_imported_capacitive_reactive_energy">
      <function>3</function>
      <start_addr>5116</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="previous_day_import_inductive_apparent_energy">
      <function>3</function>
      <start_addr>5118</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <value_ref_id valid="previous_day_import_capacitive_apparent_energy">
      <function>3</function>
      <start_addr>5120</start_addr>
      <quantity>2</quantity>
      <type>float</type>
    </value_ref_id>

    <packet>
      <function>3</function>
      <start_addr>4096</start_addr>
      <quantity>30</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4134</start_addr>
      <quantity>28</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4166</start_addr>
      <quantity>14</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4184</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4192</start_addr>
      <quantity>18</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4224</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4238</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4252</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4266</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4280</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4294</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4308</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4322</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4420</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4434</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4448</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4504</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4518</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4544</start_addr>
      <quantity>4</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4560</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4574</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4840</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4854</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4868</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4882</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4896</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4910</start_addr>
      <quantity>2</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>4996</start_addr>
      <quantity>6</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>5040</start_addr>
      <quantity>8</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>5112</start_addr>
      <quantity>10</quantity>
    </packet>

    <packet>
      <function>3</function>
      <start_addr>5172</start_addr>
      <quantity>10</quantity>
    </packet>

    </modbus>
  </protocol>

</APC_DDF>

